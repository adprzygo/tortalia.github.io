<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tortalia - Wyjątkowe Torty</title>
    <!-- React & Babel for Browser Rendering -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Inter:wght@400;500;600;700&display=swap');
        
        body { font-family: 'Inter', sans-serif; }
        .font-serif { font-family: 'Playfair+Display', serif; }
        
        /* Smooth scrolling */
        html { scroll-behavior: smooth; }

        .animate-in {
            animation: slideIn 0.3s ease-out forwards;
        }
        @keyframes slideIn {
            from { transform: translateY(-10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* Sparkle animation for AI elements */
        .sparkle-text {
            background: linear-gradient(90deg, #f43f5e, #fb7185, #fda4af, #f43f5e);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shine 3s linear infinite;
        }
        @keyframes shine {
            to { background-position: 200% center; }
        }
    </style>
</head>
<body class="bg-rose-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // Gemini API Configuration
        const apiKey = ""; // Klucz API zostanie uzupełniony w środowisku
        const geminiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

        const Icon = ({ name, size = 20, className = "" }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (window.lucide && iconRef.current) {
                    const lucideName = name.replace(/([a-z0-9])([A-Z])/g, '$1-$2').toLowerCase();
                    const i = document.createElement('i');
                    i.setAttribute('data-lucide', lucideName);
                    if (className) i.setAttribute('class', className);
                    iconRef.current.innerHTML = '';
                    iconRef.current.appendChild(i);
                    window.lucide.createIcons({
                        attrs: { width: size, height: size, 'stroke-width': 2 }
                    });
                }
            }, [name, size, className]);
            return <span ref={iconRef} className="inline-flex items-center justify-center leading-none" />;
        };

        const App = () => {
            const [isMenuOpen, setIsMenuOpen] = useState(false);
            const [activeTab, setActiveTab] = useState('home');
            const [formStatus, setFormStatus] = useState(''); // '', 'sending', 'success', 'error'
            
            // Gemini State
            const [aiInput, setAiInput] = useState('');
            const [aiSuggestion, setAiSuggestion] = useState(null);
            const [isAiLoading, setIsAiLoading] = useState(false);
            const [aiError, setAiError] = useState(null);

            const flavors = [
                {
                    title: "Strawberry Oreo",
                    description: "Puszysty biszkopt czekoladowy, krem Oreo, konfitura truskawkowa oraz curd marakuja.",
                    image: "https://images.unsplash.com/photo-1565958011703-44f9829ba187?auto=format&fit=crop&q=80&w=800",
                    tag: "Klasyk"
                },
                {
                    title: "Pistachio Lover",
                    description: "Biszkopt pistacjowy, mus pistacjowy, krem malinowy oraz konfitura malinowa.",
                    image: "https://images.unsplash.com/photo-1535231544450-b4125c86c0bd?auto=format&fit=crop&q=80&w=800",
                    tag: "Premium"
                },
                {
                    title: "White Bueno",
                    description: "Biszkopt czekoladowy, krem Kinder Bueno White i coulis malinowe.",
                    image: "https://images.unsplash.com/photo-1606890737304-57a1ca8a5b62?auto=format&fit=crop&q=80&w=800",
                    tag: "Dla dzieci"
                },
                {
                    title: "Lemon Fresh",
                    description: "Jasny biszkopt, krem śmietankowy, krem cytrynowy i świeże maliny.",
                    image: "https://images.unsplash.com/photo-1519340333755-50852443e797?auto=format&fit=crop&q=80&w=800",
                    tag: "Orzeźwiający"
                }
            ];

            const scrollToSection = (id) => {
                setActiveTab(id);
                setIsMenuOpen(false);
                const element = document.getElementById(id);
                if (element) {
                    const offset = 80;
                    const bodyRect = document.body.getBoundingClientRect().top;
                    const elementRect = element.getBoundingClientRect().top;
                    const elementPosition = elementRect - bodyRect;
                    const offsetPosition = elementPosition - offset;
                    window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
                }
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setFormStatus('sending');
                const form = e.target;
                const formData = new FormData(form);
                
                try {
                    // Wysłanie do Formspree (ID: mbdlvnnn)
                    const response = await fetch("https://formspree.io/f/mbdlvnnn", {
                        method: "POST",
                        body: formData,
                        headers: { 'Accept': 'application/json' }
                    });
                    
                    if (response.ok) {
                        setFormStatus('success');
                        form.reset();
                    } else {
                        setFormStatus('error');
                    }
                } catch (error) {
                    setFormStatus('error');
                }
            };

            // Gemini API Call
            const generateAiSuggestion = async () => {
                if (!aiInput.trim()) return;
                
                setIsAiLoading(true);
                setAiError(null);
                
                const systemInstruction = `Jesteś ekspertem cukierniczym pracowni Tortalia prowadzonej przez Natalię. 
                Pomóż klientowi zaprojektować profil smakowy tortu na podstawie jego opisu. 
                Twoje odpowiedzi powinny być: 
                1. Kreatywne i eleganckie.
                2. Spójne z estetyką premium (używaj słów takich jak: aksamitny, mus, konfitura, curd, szlachetna czekolada).
                3. Zawsze kończ propozycję miłym zaproszeniem do kontaktu z Natalią.
                Format odpowiedzi: Krótka nazwa smakowa, a następnie szczegółowy opis warstw.`;

                const callGemini = async (retryCount = 0) => {
                    try {
                        const response = await fetch(geminiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                contents: [{ parts: [{ text: `Klient szuka tortu na: ${aiInput}. Zaproponuj coś wyjątkowego.` }] }],
                                systemInstruction: { parts: [{ text: systemInstruction }] }
                            })
                        });

                        if (!response.ok) {
                            if (response.status === 429 && retryCount < 5) {
                                const delay = Math.pow(2, retryCount) * 1000;
                                await new Promise(res => setTimeout(res, delay));
                                return callGemini(retryCount + 1);
                            }
                            throw new Error('Wystąpił problem z połączeniem z AI.');
                        }

                        const result = await response.json();
                        const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                        setAiSuggestion(text);
                    } catch (err) {
                        setAiError('Nie udało się wygenerować propozycji. Spróbuj ponownie za chwilę.');
                    } finally {
                        setIsAiLoading(false);
                    }
                };

                await callGemini();
            };

            return (
                <div className="min-h-screen text-gray-800">
                    {/* Nawigacja */}
                    <nav className="fixed w-full bg-white/90 backdrop-blur-md shadow-sm z-50">
                        <div className="max-w-6xl mx-auto px-4 h-20 flex justify-between items-center">
                            <div className="flex items-center gap-2 cursor-pointer" onClick={() => scrollToSection('home')}>
                                <Icon name="Cake" className="text-rose-400" size={32} />
                                <span className="text-2xl font-serif font-bold text-rose-500 tracking-tight">Tortalia</span>
                            </div>
                            <div className="hidden md:flex gap-8 font-medium">
                                {['home', 'smaki', 'o-mnie', 'kontakt'].map((tab) => (
                                    <button 
                                        key={tab} 
                                        onClick={() => scrollToSection(tab)} 
                                        className={`capitalize transition-colors hover:text-rose-500 ${activeTab === tab ? 'text-rose-500 underline decoration-2 underline-offset-8' : ''}`}
                                    >
                                        {tab.replace('-', ' ')}
                                    </button>
                                ))}
                            </div>
                            <button className="md:hidden text-rose-500" onClick={() => setIsMenuOpen(!isMenuOpen)}>
                                <Icon name={isMenuOpen ? "X" : "Menu"} size={28} />
                            </button>
                        </div>
                        {isMenuOpen && (
                            <div className="md:hidden bg-white border-t border-rose-100 flex flex-col p-4 gap-4 animate-in">
                                {['home', 'smaki', 'o-mnie', 'kontakt'].map((tab) => (
                                    <button key={tab} onClick={() => scrollToSection(tab)} className="capitalize text-lg font-medium p-2 text-left">{tab.replace('-', ' ')}</button>
                                ))}
                            </div>
                        )}
                    </nav>

                    {/* Sekcja Home */}
                    <section id="home" className="pt-32 pb-20 px-4">
                        <div className="max-w-6xl mx-auto flex flex-col md:flex-row items-center gap-12">
                            <div className="flex-1 space-y-6">
                                <span className="inline-block px-4 py-1 bg-rose-200 text-rose-700 rounded-full text-sm font-bold uppercase tracking-widest italic">Słodkie chwile na zamówienie</span>
                                <h1 className="text-5xl md:text-7xl font-serif font-bold text-gray-900 leading-tight">Tortalia <br/><span className="text-rose-400">Wyjątkowe smaki</span></h1>
                                <p className="text-lg text-gray-600 max-w-lg">Tworzę z pasji do cukiernictwa i miłości do perfekcyjnych tortów – takich, które zachwycają nie tylko wyglądem, ale przede wszystkim smakiem.</p>
                                <div className="flex gap-4">
                                    <button onClick={() => scrollToSection('smaki')} className="bg-rose-500 text-white px-8 py-4 rounded-xl font-bold shadow-lg hover:bg-rose-600 transition-all transform hover:-translate-y-1">Zobacz ofertę</button>
                                    <button onClick={() => scrollToSection('kontakt')} className="bg-white border-2 border-rose-200 text-rose-500 px-8 py-4 rounded-xl font-bold hover:bg-rose-50 transition-all">Złóż zamówienie</button>
                                </div>
                            </div>
                            <div className="flex-1 relative">
                                <div className="absolute -inset-4 bg-rose-200 rounded-[2rem] rotate-3 blur-sm opacity-50"></div>
                                {/* ZMIANA: Zdjęcie misio.jpg (upewnij się co do rozszerzenia pliku na GitHubie!) */}
                                <img src="misio.jpg" className="relative rounded-[2rem] shadow-2xl w-full object-cover aspect-[4/5]" alt="Tortalia - Nasza specjalność" />
                            </div>
                        </div>
                    </section>

                    {/* AI Magic Section - AI Kreator Słodkości */}
                    <section className="py-20 bg-gradient-to-br from-rose-50 to-white">
                        <div className="max-w-4xl mx-auto px-4 text-center">
                            <div className="inline-flex items-center gap-2 mb-4 px-4 py-1 rounded-full bg-white border border-rose-100 shadow-sm">
                                <Icon name="Sparkles" className="text-rose-400" size={16} />
                                <span className="text-xs font-bold text-rose-500 uppercase tracking-widest">Wirtualny Asystent</span>
                            </div>
                            <h2 className="text-4xl font-serif font-bold mb-6 sparkle-text">AI Kreator Słodkości ✨</h2>
                            <p className="text-gray-600 mb-10 max-w-2xl mx-auto">
                                Nie wiesz jaki smak wybrać? Opisz nam okazję, ulubione składniki lub styl uroczystości, a nasza sztuczna inteligencja zaproponuje coś unikalnego specjalnie dla Ciebie!
                            </p>
                            
                            <div className="bg-white p-2 rounded-2xl shadow-xl shadow-rose-100 flex flex-col md:flex-row gap-2 mb-8">
                                <input 
                                    value={aiInput}
                                    onChange={(e) => setAiInput(e.target.value)}
                                    type="text" 
                                    placeholder="Np: Tort na 5 urodziny dla fanki dinozaurów, kochamy czekoladę..."
                                    className="flex-1 p-4 bg-transparent outline-none text-gray-700 placeholder-gray-400"
                                />
                                <button 
                                    onClick={generateAiSuggestion}
                                    disabled={isAiLoading}
                                    className="bg-rose-500 text-white px-8 py-4 rounded-xl font-bold text-xl transition-all hover:bg-rose-600 disabled:bg-rose-300 flex items-center justify-center gap-2"
                                >
                                    {isAiLoading ? <Icon name="Loader2" className="animate-spin" /> : <Icon name="MagicWand" />}
                                    {isAiLoading ? 'Mieszamy smaki...' : 'Zaproponuj smak ✨'}
                                </button>
                            </div>

                            {aiSuggestion && (
                                <div className="bg-white p-8 rounded-3xl border border-rose-100 shadow-sm text-left animate-in relative overflow-hidden">
                                    <div className="absolute top-0 right-0 p-4 opacity-5">
                                        <Icon name="Cake" size={120} />
                                    </div>
                                    <h3 className="text-rose-500 font-bold text-lg mb-3 flex items-center gap-2">
                                        <Icon name="Stars" size={20} /> Propozycja Twojego Tortu:
                                    </h3>
                                    <div className="text-gray-700 leading-relaxed whitespace-pre-line font-medium italic">
                                        {aiSuggestion}
                                    </div>
                                    <button 
                                        onClick={() => {
                                            const contactSection = document.getElementById('kontakt');
                                            contactSection.scrollIntoView({ behavior: 'smooth' });
                                        }}
                                        className="mt-6 text-rose-500 font-bold flex items-center gap-2 hover:underline"
                                    >
                                        Chcę zamówić ten tort <Icon name="ArrowRight" size={16} />
                                    </button>
                                </div>
                            )}

                            {aiError && (
                                <p className="text-red-400 text-sm mt-4 font-medium">{aiError}</p>
                            )}
                        </div>
                    </section>

                    {/* Sekcja O mnie */}
                    <section id="o-mnie" className="py-20 bg-white">
                        <div className="max-w-6xl mx-auto px-4 flex flex-col md:flex-row items-center gap-12">
                            <div className="flex-1 hidden md:block">
                                {/* Zdjęcie misio.jpg również tutaj dla spójności */}
                                <img src="misio.jpg" className="rounded-full w-80 h-80 object-cover shadow-2xl border-8 border-rose-50 mx-auto" alt="Natalia - Tortalia" />
                            </div>
                            <div className="flex-1 text-center md:text-left">
                                <Icon name="Heart" className="text-rose-400 mb-6" size={48} />
                                <h2 className="text-4xl font-serif font-bold mb-8">Witaj w moim słodkim świecie!</h2>
                                <div className="text-lg text-gray-600 space-y-6">
                                    <p>Cześć! Nazywam się Natalia. Moja przygoda z cukiernictwem zaczęła się od marzenia o tworzeniu tortów, które będą sercem każdej ważnej uroczystości.</p>
                                    <p>Każdy wypiek, który wychodzi z mojej pracowni, powstaje z najwyższej jakości składników: prawdziwego masła, szlachetnej czekolady i najświeższych owoców.</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Sekcja Smaki - Tytuł "Moje torty" */}
                    <section id="smaki" className="py-20 bg-rose-50">
                        <div className="max-w-6xl mx-auto px-4">
                            <h2 className="text-4xl font-serif font-bold text-center mb-16 underline decoration-rose-200 underline-offset-8">Moje torty</h2>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                                {flavors.map((flavor, i) => (
                                    <div key={i} className="bg-white rounded-3xl overflow-hidden shadow-xl hover:-translate-y-2 transition-all group">
                                        <div className="relative h-64">
                                            <img src={flavor.image} className="h-full w-full object-cover transition-transform duration-500 group-hover:scale-110" alt={flavor.title} />
                                            <div className="absolute top-4 left-4 bg-white/95 px-3 py-1 rounded-full text-xs font-bold uppercase text-rose-500 tracking-wider shadow-sm">{flavor.tag}</div>
                                        </div>
                                        <div className="p-6">
                                            <h3 className="text-xl font-bold mb-3 group-hover:text-rose-500 transition-colors">{flavor.title}</h3>
                                            <p className="text-sm text-gray-600 mb-6 leading-relaxed">{flavor.description}</p>
                                            <div className="flex items-center text-rose-400 font-bold text-xs uppercase tracking-wider">
                                                Szczegóły smaku <Icon name="ChevronRight" size={14} className="ml-1" />
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </section>

                    {/* Sekcja Kontakt - Formularz z polem email */}
                    <section id="kontakt" className="py-20 bg-white">
                        <div className="max-w-6xl mx-auto px-4">
                            <div className="bg-rose-50/50 rounded-[3rem] p-8 lg:p-20 flex flex-col lg:flex-row gap-12 border border-rose-100 shadow-sm relative overflow-hidden">
                                <div className="absolute -top-10 -right-10 w-40 h-40 bg-rose-200/20 rounded-full blur-3xl"></div>
                                <div className="lg:w-1/2 relative z-10">
                                    <h2 className="text-4xl font-serif font-bold mb-8 text-center sm:text-left">Umów się na degustację</h2>
                                    <div className="space-y-8">
                                        <div className="flex items-center gap-5 group justify-center sm:justify-start">
                                            <div className="w-12 h-12 bg-white rounded-2xl shadow-sm flex items-center justify-center text-rose-400 group-hover:bg-rose-500 group-hover:text-white transition-all duration-300">
                                                <Icon name="Phone" size={24} />
                                            </div>
                                            <div>
                                                <p className="text-[10px] uppercase font-bold text-gray-400 mb-1 tracking-widest">Zadzwoń do mnie</p>
                                                <a href="tel:793942929" className="font-bold text-xl hover:text-rose-500 transition-colors tracking-tight">793 942 929</a>
                                            </div>
                                        </div>
                                        <div className="flex items-center gap-5 group justify-center sm:justify-start">
                                            <div className="w-12 h-12 bg-white rounded-2xl shadow-sm flex items-center justify-center text-rose-400 group-hover:bg-rose-500 group-hover:text-white transition-all duration-300">
                                                <Icon name="Mail" size={24} />
                                            </div>
                                            <div>
                                                <p className="text-[10px] uppercase font-bold text-gray-400 mb-1 tracking-widest">Napisz wiadomość</p>
                                                <a href="mailto:nataliatortalia@gmail.com" className="font-bold text-xl hover:text-rose-500 transition-colors tracking-tight text-xs sm:text-xl text-wrap break-all">nataliatortalia@gmail.com</a>
                                            </div>
                                        </div>
                                        <div className="flex items-center gap-5 group justify-center sm:justify-start">
                                            <div className="w-12 h-12 bg-white rounded-2xl shadow-sm flex items-center justify-center text-rose-400 group-hover:bg-rose-500 group-hover:text-white transition-all duration-300">
                                                <Icon name="Instagram" size={24} />
                                            </div>
                                            <div>
                                                <p className="text-[10px] uppercase font-bold text-gray-400 mb-1 tracking-widest">Instagram</p>
                                                <a href="https://instagram.com/_tortalia" target="_blank" className="font-bold text-xl hover:text-rose-500 transition-colors tracking-tight">_tortalia</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div className="lg:w-1/2 relative z-10 mt-12 lg:mt-0">
                                    {formStatus === 'success' ? (
                                        <div className="bg-white p-8 rounded-3xl shadow-sm border border-rose-100 text-center animate-in">
                                            <div className="w-16 h-16 bg-green-100 text-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                                <Icon name="Check" size={32} />
                                            </div>
                                            <h3 className="text-2xl font-serif font-bold mb-2 text-rose-500">Wiadomość wysłana!</h3>
                                            <p className="text-gray-600 mb-6 font-medium">Sprawdzamy termin i powrócimy z wyceną najszybciej jak to możliwe.</p>
                                            <button onClick={() => setFormStatus('')} className="text-rose-400 font-bold underline underline-offset-4 hover:text-rose-600 transition-colors">Wyślij kolejną wiadomość</button>
                                        </div>
                                    ) : (
                                        <form className="space-y-4" onSubmit={handleSubmit}>
                                            <input type="hidden" name="_subject" value="Nowe zapytanie o tort - Tortalia" />
                                            <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                                <input required name="name" type="text" className="w-full p-4 rounded-xl border-none ring-1 ring-rose-200 outline-none focus:ring-2 focus:ring-rose-400 transition-all bg-white shadow-sm" placeholder="Imię i Nazwisko" />
                                                <input required name="email" type="email" className="w-full p-4 rounded-xl border-none ring-1 ring-rose-200 outline-none focus:ring-2 focus:ring-rose-400 transition-all bg-white shadow-sm" placeholder="Twój adres e-mail" />
                                            </div>
                                            <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                                <input required name="phone" type="tel" className="w-full p-4 rounded-xl border-none ring-1 ring-rose-200 outline-none focus:ring-2 focus:ring-rose-400 transition-all bg-white shadow-sm" placeholder="Numer telefonu" />
                                                <input required name="date" type="date" className="w-full p-4 rounded-xl border-none ring-1 ring-rose-200 outline-none focus:ring-2 focus:ring-rose-400 transition-all bg-white text-gray-400 shadow-sm" />
                                            </div>
                                            <textarea required name="message" className="w-full p-4 rounded-xl border-none ring-1 ring-rose-200 outline-none focus:ring-2 focus:ring-rose-400 transition-all bg-white shadow-sm" rows="4" placeholder="Opisz swój wymarzony tort (okazja, ilość osób, smak)..."></textarea>
                                            <button disabled={formStatus === 'sending'} type="submit" className={`w-full bg-rose-500 text-white font-bold py-5 rounded-xl shadow-lg shadow-rose-200 transition-all active:scale-95 flex items-center justify-center gap-2 ${formStatus === 'sending' ? 'opacity-70 cursor-not-allowed' : 'hover:bg-rose-600 hover:-translate-y-0.5'}`}>
                                                {formStatus === 'sending' ? 'Wysyłanie...' : 'Zapisz się już dziś!'}
                                            </button>
                                        </form>
                                    )}
                                </div>
                            </div>
                        </div>
                    </section>

                    <footer className="py-16 bg-gray-900 text-gray-400">
                        <div className="max-w-6xl mx-auto px-4 text-center space-y-10">
                            <div className="flex justify-center items-center gap-3 text-white">
                                <Icon name="Cake" className="text-rose-400" size={28} />
                                <span className="text-3xl font-serif font-bold tracking-tight">Tortalia</span>
                            </div>
                            <div className="max-w-md mx-auto text-center">
                                <p className="text-white font-serif italic text-2xl mb-3 leading-tight">Podaruj swoim najbliższym to, co najsłodsze.</p>
                                <p className="text-[11px] uppercase tracking-[0.4em] font-medium opacity-60">Spraw prezent, który wywoła prawdziwy uśmiech.</p>
                            </div>
                            <div className="flex gap-8 justify-center">
                                <a href="https://instagram.com/_tortalia" target="_blank" className="hover:text-rose-400 transition-colors transform hover:scale-110"><Icon name="Instagram" size={24} /></a>
                            </div>
                            <div className="pt-10 border-t border-gray-800/50 text-center text-[10px] uppercase tracking-[0.2em] opacity-30">
                                &copy; 2025 Tortalia. Wszystkie prawa zastrzeżone.
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
